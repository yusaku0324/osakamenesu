---
version: "3"

includes:
  core: ./core.yml      # COUNT, WT_DIR ãªã©
  tests: ./tests.yml    # link ã‚„ validate ã«ä¾å­˜
  parallel: ./parallel.yml

# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é…ç½®ï¼†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å†å®Ÿè¡Œç”¨

tasks:
  #â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # â‘  generate_recruit_posts.py ã‚’é©åˆ‡ãªå ´æ‰€ã¸ã‚³ãƒ”ãƒ¼
  #â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  move-module:
    desc: "copy generate_recruit_posts.py â†’ bot/services/twitter_client/"
    cmds:
      - |
        SRC="generate_recruit_posts.py"
        DEST="bot/services/twitter_client/generate_recruit_posts.py"
        if [ -f "$DEST" ]; then
          echo "âœ… $DEST æ—¢ã«å­˜åœ¨ â€” skip"
        else
          if [ -f "$SRC" ]; then
            mkdir -p "$(dirname "$DEST")"
            cp -p "$SRC" "$DEST"
            echo "ğŸ”§ copied $SRC â†’ $DEST"
          else
            echo "âš ï¸  $SRC ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å ´æ‰€ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚" && exit 1
          fi
        fi

  #â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # â‘¡ 12 ä¸¦åˆ—ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å†å®Ÿè¡Œ
  #â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  run12:
    desc: "fix module â†’ tests link â†’ validate â†’ parallel pipeline"
    deps:
      - move-module
      - tests:link            # main/tests ã‚’å„ worktree ã¸ãƒªãƒ³ã‚¯
      - tests:validate-linked # pytest dry-run
      - parallel:run
      - parallel:pick
    cmds:
      - echo "ğŸ‰  generate_recruit_posts import fix & pipeline complete" 